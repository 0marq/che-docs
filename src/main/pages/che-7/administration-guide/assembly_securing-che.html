<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Securing Che</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<hr>
<div class="paragraph">
<p>title: Securing Che
keywords:
tags: []
sidebar: che_7_docs
permalink: che-7/securing-che.html
folder: che-7/administration-guide
summary:
---</p>
</div>
<h1 id="securing-che_{context}" class="sect0">Securing Che</h1>
<div class="sect1">
<h2 id="user-authentication_securing-che">User authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document covers all aspects of the authentication of users inside Eclipse Che both on the Che Server and inside the workspaces. This includes securing all the REST API endpoints, WebSocket/JSON RPC connections, and some web resources. Each of the authentication types uses the <a href="https://jwt.io/introduction/">JWT open standard</a> as a container for transferring user identity information. In addition, the Che server authentication is based on the <a href="https://openid.net/connect/">OpenID Connect</a> protocol implementation, which is provided by default by <a href="https://www.keycloak.org/">Keycloak</a>. Authentication on workspaces implies issuance of the self-signed per-workspace JWT tokens and their verification on the dedicated service based on <a href="https://www.keycloak.org/">JWTProxy</a>.</p>
</div>
<div class="sect2">
<h3 id="authentication-on-the-che-server-using-openid_user-authentication">Authentication on the Che server using OpenID</h3>
<div class="paragraph">
<p>OpenId authentication on the Che server implies the presence of an external OpenID Connect provider and has the following main steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authenticate the user through the JWT token that is retrieved from the HTTP request or redirect the user to log in page on Keycloak, in case of a missing or invalid token.</p>
</li>
<li>
<p>Authentication tokens should be send in an Authorization header. Also, in limited cases when it is not possible to use the Authorization header, the token can be sent in the token query parameter. Example: OAuth authentication initialization.</p>
</li>
<li>
<p>The Composition of an internal <code>subject</code> object that represents the current user inside the Che server code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Currently, the only supported and tested OpenID provider is Keycloak.</p>
</div>
<div class="sect3">
<h4 id="procedure-authentication-on-the-che-server-using-openid">Procedure</h4>
<div class="paragraph">
<p>To authenticate the Che server using the OpenID authentication:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Request the OpenID settings service where clients can find all the necessary URLs and properties of the OpenId provider such as jwks.endpoint, token.endpoint, logout.endpoint, realm.name, client_id returned in the JSON format.</p>
</li>
<li>
<p>The service URL is <code>&lt;che.host&gt;:&lt;che.port&gt;/api/keycloak/settings</code> and it is only available in the Che multi-user mode. The presence of the service in the URL, confirms that the authentication is enabled in the current deployment.</p>
<div class="paragraph">
<p>Example output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "che.keycloak.token.endpoint": "http://172.19.20.9:5050/auth/realms/che/protocol/openid-connect/token",
    "che.keycloak.profile.endpoint": "http://172.19.20.9:5050/auth/realms/che/account",
    "che.keycloak.client_id": "che-public",
    "che.keycloak.auth_server_url": "http://172.19.20.9:5050/auth",
    "che.keycloak.password.endpoint": "http://172.19.20.9:5050/auth/realms/che/account/password",
    "che.keycloak.logout.endpoint": "http://172.19.20.9:5050/auth/realms/che/protocol/openid-connect/logout",
    "che.keycloak.realm": "che"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, this service allows   downloading the JS client library to interact with the provider using the <code>&lt;che.host&gt;:&lt;che.port&gt;/api/keycloak/OIDCKeycloak.js</code> URL.</p>
</div>
</li>
<li>
<p>Redirect the user to the appropriate provider’s login page with all the necessary parameters like client_id, return redirection path. This can be done with any client library (JS or Java).</p>
</li>
<li>
<p>After the user is logged in to the provider and the client side code is obtained, and the JWT token has validated the token , the creation of the subject begins.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Verification of the token signature occurs in two main steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authentication: Token is extracted from the Authorization header or from the <code>token</code> query parameter and is parsed using the public key retrieved from the provider. In case of expired, invalid, or malformed tokens, a <code>403</code> error is sent to the user. The usage of the query parameter should be minimised as much as possible, since its support may be limited or dropped at some point.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the validation is successful, the parsed form of the token is passed to the environment initialization  step:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Environment initialization. The filter extracts data from the JWT token claims, creates the user in the local database if it is not yet present, and constructs the <code>subject</code> object and sets it into the per-request <strong>EnvironmentContext</strong> object, which is statically accessible everywhere.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the request was made using only a machine token, the following   single authentication filter is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>org.eclipse.che.multiuser.machine.authentication.server.MachineLoginFilter</strong>: Finds the user that the userId token belongs to, retrieves the user instance, and sets the principal to the session.
The Che server-to-server requests are performed using dedicated request factory that signs every request with the current subject token obtained from the EnvironmentContext object.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="providing-user-specific-data_authentication-on-the-che-server-using-openid">Providing user-specific data</h4>
<div class="paragraph">
<p>Since Keycloak may store user-specific information (first and last name, phone number, job title), there is a special implementation of the <strong>ProfileDao</strong> that can provide this data to consumers. The implementation is read-only, so users can not perform create and update operations.</p>
</div>
</div>
<div class="sect3">
<h4 id="obtaining-the-token-from-keycloak_authentication-on-the-che-server-using-openid">Obtaining the token from Keycloak</h4>
<div class="paragraph">
<p>Clients that cannot run JS or other clients (like CLI or selenium tests), must request the authorization token directly from Keycloak.</p>
</div>
<div class="paragraph">
<p>To obtain the token, send a request to the token endpoint with the username and password credentials. This request can be schematically described as the following cURL request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl --data "grant_type=password&amp;client_id=&lt;client_name&gt;&amp;username=&lt;username&gt;&amp;password=&lt;password&gt;"

http://&lt;keyckloak_host&gt;:5050/auth/realms/&lt;realm_name&gt;/protocol/openid-connect/token</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the Che dashboard utilizes the native Keycloak js library, it uses a customized Keycloak login page and an authentication mechanism using the grant_type=authorization_code.
It is a two step authentication process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Logining in and obtaining the authorization code.</p>
</li>
<li>
<p>Obtaining the token using this code.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authentication-on-the-che-server-using-other-authentication-implementations_user-authentication">Authentication on the Che server using other authentication implementations</h3>
<h4 id="_procedure" class="discrete">Procedure</h4>
<div class="paragraph">
<p>To adapt an OIDC authentication implementation, other than Keycloak:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the authentication configuration parameters that are stored in the multiuser.properties file (such as client ID, authentication URL, realm name).</p>
</li>
<li>
<p>Write a single filter or a chain of filters to validate tokens, create the user in the Che dashboard, and compose the subject object.</p>
</li>
<li>
<p>If the new authorization provider supports the OpenID protocol, use the OIDC JS client library available at the settings endpoint since it is maximally decoupled of specific implementations.</p>
</li>
<li>
<p>If the selected provider stores additional data about the user (first and last name, job title), it is recommended to write a provider-specific ProfileDao implementation that provides this information.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="authentication-on-the-che-server-using-oauth_user-authentication">Authentication on the Che server using OAuth</h3>
<div class="paragraph">
<p>For easy user interaction with third party services, the Che server supports OAuth authentication. OAuth tokens are also used for GitHub-related plug-ins.</p>
</div>
<div class="paragraph">
<p>OAuth authentication has two main flows - internal and external, which is based on the Keycloak brokering mechanism. The following are the two main OAuth API implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>org.eclipse.che.security.oauth.EmbeddedOAuthAPI</strong>, for the internal flow.</p>
</li>
<li>
<p><strong>org.eclipse.che.multiuser.keycloak.server.oauth2.DelegatedOAuthAPI</strong>,forthe external flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the the che.oauth.service_mode=&lt;embedded|delegated&gt; configuration property to switch between the two implementations.
The main REST endpoint in the OAuth API is <strong>org.eclipse.che.security.oauth.OAuthAuthenticationService, which contains</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authenticate method to start the OAuth authentication flow</p>
</li>
<li>
<p>Callback method to process callbacks from the provider</p>
</li>
<li>
<p>Token to retrieve current user’s oAuth token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These methods refer to the currently activated embedded or delegated OAuthAPI that does the underlying operations like finding the appropriate authenticator, initializing the login process, user forwarding.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-swagger-or-rest-clients-to-execute-queries_user-authentication">Using Swagger or REST clients to execute queries</h3>
<div class="paragraph">
<p>The user’s Keycloak token is used to execute queries to the secured API on the user’s  behalf through REST clients. A valid token must be attached as a request header or the <code>?token=$token</code> query parameter.</p>
</div>
<div class="paragraph">
<p>Access the Che Swagger at <code><a href="http://che_host:8080/swagger" class="bare">http://che_host:8080/swagger</a></code>. A user must be signed-in through Keycloak so that the access token is included in the request header.</p>
</div>
</div>
<div class="sect2">
<h3 id="authentication-inside-the-workspace_user-authentication">Authentication inside the workspace</h3>
<div class="paragraph">
<p>Workspace containers may contain services that must be protected with authentication. Such protected services are called <code>secure</code>. For this purpose, machine authentication mechanism should be used. Machine tokens avoid passing the Keycloak tokens to the workspace containers (which can be potentially insecure). Also, Keycloak tokens may have relatively smaller lifetime and require periodic renewal or refresh which is difficult  to manage and keep in sync with the same user session tokens on clients.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="extensibility/securing_che_authentication_inside_the_workspace.png" alt="securing che authentication inside the workspace">
</div>
</div>
<div class="sect3">
<h4 id="creating-secure-servers_authentication-inside-the-workspace">Creating secure servers</h4>
<div class="paragraph">
<p>To create secure servers, set the <strong>secure</strong> attribute of the endpoint to ‘true’ in the dockerimage type component in the devfile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>apiVersion: 1.0.0
metadata:
  name: petclinic-dev-environment
components:
  - type: dockerimage
	image: eclipse/maven-jdk8:latest
	volumes:
  	- name: maven-repo
    	containerPath: /root/.m2
	env:
  	- name: ENV_VAR
    	value: value
	endpoints:
  	- name: maven-server
    	  port: 3101
    	  attributes:
      	protocol: http
      	secure: 'true'
      	public: 'true'
      	discoverable: 'false'
	memoryLimit: 1536M</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="workspace-jwt-token-_authentication-inside-the-workspace">Workspace JWT token</h4>
<div class="paragraph">
<p>Workspace tokens are JSON web tokens (<a href="https://jwt.io/">JWT</a>) that contain the following information in their claims:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>uid: The ID of the user who owns this token</p>
</li>
<li>
<p>uname: The name of the user who owns this token</p>
</li>
<li>
<p>wsid: The ID of a workspace which can be queried with this token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each user is provided with a unique personal token for each workspace.
The structure of a token and the signature are different than they are in Keycloak. The following is an example token view:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># Header
{
  "alg": "RS512",
  "kind": "machine_token"
}
# Payload
{
  "wsid": "workspacekrh99xjenek3h571",
  "uid": "b07e3a58-ed50-4a6e-be17-fcf49ff8b242",
  "uname": "john",
  "jti": "06c73349-2242-45f8-a94c-722e081bb6fd"
}
# Signature
{
  "value": "RSASHA256(base64UrlEncode(header) + . +  base64UrlEncode(payload))"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SHA-256 with RSA algorithm is used for signing machine tokens and it is not configurable. Also, there is no public service that distributes the public part of the key pair with which the token is signed.</p>
</div>
</div>
<div class="sect3">
<h4 id="machine-token-validation_authentication-inside-the-workspace">Machine token validation</h4>
<div class="paragraph">
<p>Validation of machine tokens is performed using dedicated per-workspace service with <code>JWTProxy</code> running on it in a separate pod. When the workspace starts, this service receives the public part of the SHA key from the Che server. For all the secure servers, separate verification endpoint is created. When traffic comes to that endpoint, <code>JWTProxy</code> tries to extract the token from the cookies or headers, and validates it using the public key part.</p>
</div>
<div class="paragraph">
<p>If a particular server has to query the Che server, it can use the machine token provided in the <code>CHE_MACHINE_TOKEN</code> environment variable. This token is the user’s token who starts the workspace. The scope of such requests is restricted to the current workspace only.The list of allowed operations is also strictly limited.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-authorization_securing-che">User authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authorization of users in Che is based on the permissions model. Permissions are used to control the allowed actions of users and establish a security model. Each request is verified for the presence of the required permission in the current user subject after it passes authentication. You can control resources managed by Che and allow certain actions by assigning permissions to users.</p>
</div>
<div class="paragraph">
<p>Permissions can be applied to the following entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workspace</p>
</li>
<li>
<p>Organization</p>
</li>
<li>
<p>System</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="workspace-permissions_user-authorization">Workspace permissions</h3>
<div class="paragraph">
<p>The user who creates a workspace is the workspace owner. The workspace owner by default  has the following permissions: read, use, run, configure, setPermissions, and delete. Workspace owners can invite users into the workspace and control workspace permissions for other users.</p>
</div>
<div class="paragraph">
<p>The following permissions are associated with workspaces.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows reading the workspace configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">use</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows using a workspace and interacting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">run</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows starting and stopping a workspace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows defining and changing the workspace configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPermissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows updating the workspace permissions for other users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows deleting the workspace.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="organization-permissions_user-authorization">Organization permissions</h3>
<div class="paragraph">
<p>An organization is a named set of users.</p>
</div>
<div class="paragraph">
<p>The following permissions are applicable to organizations.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows editing of the organization settings and information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows deleting an organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageSuborganizations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows creating and managing sub-organizations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageResources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows redistribution of an organization’s resources and defining the resource limits.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageWorkspaces</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows creating and managing all the organization’s workspaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPermissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows adding and removing users and updating their permissions.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="system-permissions_user-authorization">System permissions</h3>
<div class="paragraph">
<p>System permissions control aspects of the whole Che installation.</p>
</div>
<div class="paragraph">
<p>The following permissions are applicable to the system.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows control of the system, workspaces, and organizations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPermissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows updating the permissions for users on the system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows creating and managing users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">monitorSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows accessing endpoints used for monitoring the state of the server.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All system permissions are  granted to the administrative user who is configured in the <code>CHE_SYSTEM_ADMIN__NAME</code> property (the default is “admin”). The system permissions are granted when the Che server starts. If the user is not present in the Che user database, it happens after the first user’s login.</p>
</div>
</div>
<div class="sect2">
<h3 id="managesystem-permission_user-authorization">manageSystem permission</h3>
<div class="paragraph">
<p>Users with the <strong>manageSystem</strong> permission have access to the following services:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get free resource limits.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/{accountId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get free resource limits for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/{accountId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edit free resource limit for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/{accountId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove free resource limit for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/installer/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add installer to the registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/installer/{key}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update installer in the registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/installer/{key}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove installer from the registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get logging configurations in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/{name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get configurations of logger by its name in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/{name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create logger in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/{name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edit logger in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/{accountId}/details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get detailed information about resources for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/system/stop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shutdown all system services, prepare Che to stop.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="monitorsystem-permission_user-authorization">monitorSystem permission</h3>
<div class="paragraph">
<p>Users with the <strong>monitorSystem</strong> permission have access to the following services.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/activity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get workspaces in a certain state for a certain amount of time.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="super-privileged-mode_user-authorization">super-privileged mode</h3>
<div class="paragraph">
<p>The <strong>manageSystem</strong> permission can be extended to provide a <strong>super-privileged</strong> mode. This allows the user to perform advanced actions on any resources managed by the system. A user can read and stop any workspace with the <strong>manageSystem</strong> permission and assign permissions to other users as needed.
The <strong>super-privileged</strong> mode is disabled by default. To change to the <strong>super-privileged</strong> mode, set the <code>CHE_SYSTEM_SUPER<em>PRIVILEGED</em>MODE</code> variable to <code>true</code> in the <code>che.env</code> file.
Following is a list of services that are enabled for users with the <strong>manageSystems</strong> permissions and with <strong>super-privileged</strong> mode on.</p>
</div>
<div class="paragraph">
<p>options="header"]</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/workspace/namespace/{namespace:.*}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get all workspaces for the given namespace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/workspace/{id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stop a workspace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/workspace/{key:.*}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get a workspace by key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization/resource/{suborganizationId}/cap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get a resource cap for the given organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization/resource/{suborganizationId}/cap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the resource cap for a given organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization/{parent}/organizations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the child organizations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the user’s organizations.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="permissions-api_user-authorization">Permissions API</h3>
<div class="paragraph">
<p>All permissions can be managed using the provided REST API.
The APIs are documented using Swagger at <code>[{host}/swagger/#!/permissions]</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="listing-permissions_user-authorization">Listing permissions</h3>
<div class="paragraph">
<p>To list the permissions that apply to a specific resource, perform the <code>GET /permissions</code> request.</p>
</div>
<div class="paragraph">
<p>The suitable domain values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>system</p>
</li>
<li>
<p>organization</p>
</li>
<li>
<p>workspace</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note</strong>: The domain is optional. If no domain is specified, the API returns all possible permissions for all the domains.</p>
</div>
</div>
<div class="sect2">
<h3 id="listing-permissions-for-a-user_user-authorization">Listing permissions for a user</h3>
<div class="paragraph">
<p>To list the permissions that apply to a user, perform the <code>GET /permissions/{domain}</code> request.</p>
</div>
<div class="paragraph">
<p>The suitable domain values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>system</p>
</li>
<li>
<p>organization</p>
</li>
<li>
<p>workspace</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="listing-permissions-for-all-users_user-authorization">Listing permissions for all users</h3>
<div class="paragraph">
<p><strong>Note</strong>: A user must have <strong>manageSystem</strong> permissions to see this information.</p>
</div>
<div class="paragraph">
<p>To list the permissions that apply to all users, perform the <code>GET /permissions/{domain}/all</code>  request.</p>
</div>
<div class="paragraph">
<p>The suitable domain values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>system</p>
</li>
<li>
<p>organization</p>
</li>
<li>
<p>workspace</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="assigning-permissions_user-authorization">Assigning permissions</h3>
<div class="paragraph">
<p>To assign permissions to a resource, perform the <code>POST /permissions</code> request.
The suitable domain values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>system</p>
</li>
<li>
<p>organization</p>
</li>
<li>
<p>workspace</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is a message body that requests permissions for a user with a userID to a workspace with a workspaceID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "actions": [
    "read",
    "use",
    "run",
    "configure",
    "setPermissions"
  ],
  "userId": "userID",
  "domainId": "workspace",
  "instanceId": "workspaceID"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>instanceId</strong> parameter corresponds to the ID of the resource that retrieves the permission for all the users. The <strong>userId</strong> parameter corresponds to the ID of the user that has been granted certain permissions.</p>
</div>
</div>
<div class="sect2">
<h3 id="sharing-permissions_user-authorization">Sharing permissions</h3>
<div class="paragraph">
<p>A user with <strong>setPermissions</strong> privileges can share a workspace and grant read, use, run, configure, or setPermissions privileges for other users.</p>
</div>
<h4 id="_procedure_2" class="discrete">Procedure</h4>
<div class="paragraph">
<p>To share workspace permissions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select a workspace in the user dashboard.</p>
</li>
<li>
<p>Navigate to the <strong>Share</strong> tab and enter the email IDs of the users. Use commas or spaces as separators if there are multiple emails.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-07-25 15:10:44 CEST
</div>
</div>
</body>
</html>